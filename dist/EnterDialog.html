<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <style>
    body { font-family: Segoe UI, Arial, sans-serif; margin: 12px; }
    label { display: block; margin-bottom: 4px; font-size: 13px; color: #333; }
    input[type=text] {
      width: 100%; box-sizing: border-box; padding: 6px 8px;
      font-size: 14px; border: 1px solid #ccc; border-radius: 3px;
      margin-bottom: 12px;
    }
    input[type=text]:focus { border-color: #4285f4; outline: none; }
    .hint { font-size: 11px; color: #888; margin-bottom: 12px; }
    .buttons { text-align: right; margin-top: 8px; }
    button {
      padding: 6px 20px; font-size: 13px; border: 1px solid #ccc;
      border-radius: 3px; cursor: pointer; margin-left: 8px;
    }
    button.primary {
      background: #4285f4; color: white; border-color: #4285f4;
    }
  </style>
</head>
<body>
  <label for="cmd">Commands:</label>
  <input type="text" id="cmd" autofocus placeholder="A1:=1 (Row 3):-12 (A1..D4):34 (@A3-A4):56">
  <div class="hint">cell:op &mdash; =N value, 123 candidates, -123 strike, x clear. @A1 cage, (Row N), (Column X), (A1..D4) range, (@A1-B2) cage&minus;cells.</div>

  <div class="buttons">
    <button onclick="google.script.host.close()">Cancel</button>
    <button class="primary" onclick="submit()">OK</button>
  </div>

  <script>
    var cmdInput = document.getElementById("cmd");

    cmdInput.addEventListener("keydown", function(e) {
      if (e.key === "Enter") { submit(); e.preventDefault(); }
      if (e.key === "Escape") { google.script.host.close(); }
    });

    function submit() {
      var cmd = cmdInput.value.trim();
      if (!cmd) return;
      google.script.run
        .withSuccessHandler(function() { google.script.host.close(); })
        .withFailureHandler(function(err) { alert(err.message); })
        .addChangesFromInput(cmd);
    }
  </script>
</body>
</html>
